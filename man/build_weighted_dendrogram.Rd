% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/build_weighted_dendrogram.R
\name{build_weighted_dendrogram}
\alias{build_weighted_dendrogram}
\title{Build transformation-weighted molecular characteristics dendrogram}
\usage{
build_weighted_dendrogram(
  mol_file,
  peak2peak_file,
  numtrans_file,
  sample_name = "Dataset",
  output_dir = ".",
  clustering_method = "average",
  remove_isotopes = TRUE,
  mol_features = c("C", "H", "N", "P", "O", "S", "DBE", "AI_Mod", "kdefect"),
  ratio_features = c("OtoC_ratio", "HtoC_ratio", "NtoC_ratio", "PtoC_ratio",
    "NtoP_ratio")
)
}
\arguments{
\item{mol_file}{Path to the molecular CSV file (*Mol.csv) or data.frame}

\item{peak2peak_file}{Path to the peak.2.peak CSV file (*peak.2.peak.csv) or data.frame}

\item{numtrans_file}{Path to the num.peak.trans CSV file (*num.peak.trans.csv) or data.frame}

\item{sample_name}{Name of the dataset (used for output files, default: "Dataset")}

\item{output_dir}{Directory to save the resulting tree (default: current directory)}

\item{clustering_method}{Clustering method for hclust (default: "average")}

\item{remove_isotopes}{Whether to remove C13 isotopic peaks (default: TRUE)}

\item{mol_features}{Vector of molecular features to use for distance calculation}

\item{ratio_features}{Vector of ratio features to use for distance calculation}
}
\value{
A list containing the phylogenetic tree, distance matrices, and processed data
}
\description{
This function generates a phylogenetic tree based on both molecular characteristics
and transformation network distances. It multiplies molecular distance (based on 
elemental composition and ratios) with transformation network distance to create
a weighted dendrogram, following the original RED 2020 methodology.
}
\examples{
\dontrun{
# Using file paths
result <- build_weighted_dendrogram(
  mol_file = "Dataset_Mol.csv",
  peak2peak_file = "Dataset_All-Trans_peak.2.peak.csv",
  numtrans_file = "Dataset_All-Trans_num.peak.trans.csv",
  sample_name = "MyDataset"
)
}
}
